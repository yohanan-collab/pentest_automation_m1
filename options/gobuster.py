import subprocess

def GobusterEnum(url, html_render = False):
    # Run gobuster command
    command = ['gobuster', '-e', '-u', url, '-w', 'wordlist/common.txt']
    gobuster_output = subprocess.run(command, capture_output=True).stdout.decode()


        # Extract subdirectories and status codes from gobuster output
    subdirs = []
    for line in gobuster_output.split('\n'):
        if line.strip() and line.strip().startswith('http'):
            subdir = f' - {line.strip()}'
            subdirs.append(subdir)
    if html_render:
        # Render subdirectories as HTML table
        html_table = '<table>\n<tr><th>Subdirectories</th></tr>\n'
        for subdir in subdirs:
            html_table += f'<tr><td>{subdir}</td></tr>\n'
        html_table += '</table>\n'
        return html_table
    else:
        print('''
*******************************************
*                                         *
*           Subdirectories Found          *
*                                         *
*******************************************

{}
'''.format('\n'.join(subdirs)))
