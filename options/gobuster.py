import subprocess

def GobusterEnum(url, html_render = False):
    # Run gobuster command
    command = ['gobuster', '-e', '-u', url, '-w', 'wordlist/common.txt']
    gobuster_output = subprocess.run(command, capture_output=True).stdout.decode()


        # Extract subdirectories and status codes from gobuster output
    subdirs = []
    for line in gobuster_output.split('\n'):
        if line.strip() and line.strip().startswith('http'):
            subdir = f' - {line.strip()}'
            subdirs.append(subdir)
    if html_render:
        # Render subdirectories as HTML table
        html_table = "<table class='w-full'>\n<thead>\n<tr>\n<th class='px-4 py-2'>Subdirectories</th>\n</tr>\n</thead>\n<tbody>"
        for subdir in subdirs:
            html_table += f"<tr class='border-b'><td class='border px-4 py-2'>{subdir}</td></tr>\n"
        html_table += "</tbody>\n</table>"
        return html_table
    else:
        print('''
*******************************************
*                                         *
*           Subdirectories Found          *
*                                         *
*******************************************

{}
'''.format('\n'.join(subdirs)))
