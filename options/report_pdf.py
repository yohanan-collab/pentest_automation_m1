from colorama import Fore
from tabulate import tabulate

from options.new_scan import Nmap



def report_pdf():
    try:
        target = input(Fore.YELLOW + ">>> Enter the target\n>>> ")

        # Utilisation de NmapHostDiscovery au lieu de Nmap pour une meilleure lisibilit√©
        results = Nmap(target)

        if results:
            headers = ["ID", "Port", "Service", "Version"]
            formatted_results = [[i+1, result[1], result[2], result[3]] for i, result in enumerate(results)]
            print(tabulate(formatted_results, headers=headers, tablefmt="grid"))
        else:
            print("No results found.")
    except Exception as e:
        print("An error occurred:", str(e))