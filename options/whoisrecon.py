from tabulate import tabulate
import whois as w

def whois_query(domain):
    displayInfos = f"\n\n===================================\n"
    displayInfos += f"Whois lookup for {domain}"
    displayInfos += f"\n===================================\n"
    try:
        data = w.whois(domain)
        table_data = []
        for key, value in data.items():
            if isinstance(value, list):
                value = ', '.join(value)
            table_data.append([key, value])
        table = tabulate(table_data, headers=["Field", "Value"], tablefmt="grid")
        displayInfos += table
        return displayInfos
    except Exception as e:
        error = "Error: " + str(e)
        displayInfos += error
        return displayInfos