import subprocess
from colorama import Fore
from tabulate import tabulate
from menu import ExploitCve
from options.new_scan import Nmap
from scanbot import Menu


# target = input(Fore.CYAN + ">>> Enter the target\n>>> ")
# results = Nmap(target)

# if results:
#     headers = ["ID", "Port", "Service", "Version"]
#     formatted_results = [[i+1, result[1], result[2], result[3]] for i, result in enumerate(results)]
#     print(tabulate(formatted_results, headers=headers, tablefmt="grid"))

ExploitCve()
subOption = input(">>> Enter your choice\n>>> ")
if subOption == '1':
    
    with open("cve.txt", "r") as f:
        for cve_id in cve_lists:
            cve_id = f.read(cve_id)
            result = subprocess.run(["searchsploit", "--cve", cve_id])
            print(result)
elif subOption == '2':
    Menu()
else:
    print("Invalid choice.")